datasource db {
  provider = "mongodb"
  url      = env("MONGODB_URI")
}

generator client {
  provider = "prisma-client-js"
}

model Users {
  id                        String         @id @default(auto()) @map("_id") @db.ObjectId
  firstName                 String
  lastName                  String
  email                     String         @unique
  role                      UserRole       @default(user)
  phoneNumber               String         @unique
  alternateNumber           String?
  password                  String
  isVerified                Boolean        @default(false)
  isBlocked                 Boolean        @default(false)
  isActive                  Boolean        @default(true)
  images                    ImageGallery[]
  passwordResetToken        String?
  passwordResetTokenExpires DateTime?
  verificationToken         String?
  verificationTokenExpires  DateTime?
  News                      News[]
}

enum UserRole {
  superadmin
  admin
  user
}

model FamilyTree {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  treeData  Json
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model News {
  id          String         @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  slug        String         @unique
  excerpt     String?
  content     String
  images      ImageGallery[]
  tags        String[]
  isPublished Boolean        @default(false)
  publishedAt DateTime?
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
  views       Int            @default(0)

  categoryId String   @db.ObjectId
  category   Category @relation(fields: [categoryId], references: [id])

  authorId String @db.ObjectId
  author   Users  @relation(fields: [authorId], references: [id])
}

model Category {
  id   String @id @default(auto()) @map("_id") @db.ObjectId
  name String
  slug String @unique
  news News[]
}

type ImageGallery {
  url    String
  fileId String
}
